NOTES TO SELF

To list containers:

docker container ls -a

To get rid of all stopped containers:

docker container prune

To login to a built container:

docker exec -it <container> /bin/bash

UPDATE PROCEDURE
  # start docker running
  ./control --no-cache build focal
  # maybe "docker container rm focal"
  # you can use a comma-separated list of versions if you want:
  ./control --versions x.y.z run focal
  # gather will collect data from all R versions run in a given container:
  ./control gather focal
  # check docker-data/stdout-R-x.y.z and pkg_data-R-x.y.z.csv. E.g.:
  wc -l docker-data/pkg*
  ./control write
   Rscript -e 'source("Rversions.R")'
   # rebuild package
   Rscript -e 'devtools::install()'
   # check new data, e.g.
   Rscript -e 'print(table(rcheology::rcheology$Rversion))'
   # update version number in DESCRIPTION

   # update NEWS.md
   Rscript -e 'rmarkdown::render("README.Rmd")'
   rm README.html
   git commit -a --no-verify
   git push
   source("make-app-data.R") # seems not to work via Rscript?
   # run app.R locally, make sure it looks OK
   # publish to shinyapps.io
   
   # check it's passed appveyor
   # run checks:
   Rscript -e 'devtools::check()'
   # can we do this from command line??
   devtools::check_win_devel()
   devtools::check_win_release()
   # rhc <- rhub::check_for_cran()
   rdc <- revdepcheck::revdep_check()
   # check CRAN for previous check failures to fix:
   # https://cran.r-project.org/web/checks/check_results_rcheology.html
   # update cran-comments.md appropriately
   devtools::release()
   
   # when it's accepted, tag release
   rm CRAN-SUBMISSION
   git tag -m "Version X.Y.Z.0 on CRAN" -a vX.Y.Z.0
   git push --tags
   # reset revdepcheck
   Rscript -e 'revdepcheck::revdep_reset()'
